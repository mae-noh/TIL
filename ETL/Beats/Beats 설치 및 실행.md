# Beats

## FileBeats

- 파일비트 설치

- 파일비트 yml 파일 설정
```
filebeat.inputs:
#============================인덱스 구분==============================================
# 새로운 로그 인덱스를 생성할 경우 추가. (tomcat log, apache log...)
# Logstash 설정도 변경해 줘야 한다.
- type: log
  tags: ["iis"] # Logstash 에서 분기하여 저장할 새로운 타입 명칭
  enabled: true

  # 색인할 로그 파일 경로
  paths:
    - <로그 경로>

  # 색인대상 데이터의 시작 패턴 지정 (예시: 로그의 시작 문자가 시간인 경우)
  multiline.pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}[[:space:]][0-9]{2}:[0-9]{2}:[0-9]{2}
  multiline.negate: true
  multiline.match: after

- type: log
  tags: ["tomcat"] # Logstash 에서 분기하여 저장할 새로운 타입 명칭
  enabled: true

  # 색인할 로그 파일 경로
  paths:
    - <로그 경로>

  # 색인대상 데이터의 시작 패턴 지정 (예시: 로그의 시작 문자가 시간인 경우)
  multiline.pattern: ^[0-9]{2}-
  multiline.negate: true
  multiline.match: after
#===================================================================================
- type: log
  tags: ["jira"]
  enabled: true
  paths:
    - <로그 경로>

  multiline.pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}[[:space:]][0-9]{2}:[0-9]{2}:[0-9]{2}
  multiline.negate: true
  multiline.match: after
#============================= Filebeat modules ===============================

filebeat.config.modules:
  # Glob pattern for configuration loading
  path: ${path.config}/modules.d/*.yml

  # Set to true to enable config reloading
  reload.enabled: false

  # Period on which files under path should be checked for changes
  #reload.period: 10s

output.logstash:
  # The Logstash hosts
  # Logstash 경로 (방화벽 허용해야 됨)
  hosts: ["<Logstash HOST>:5044"]

# Configure processors to enhance or manipulate events generated by the beat.
#================================ Processors =====================================

processors:
  - add_host_metadata: ~
  - add_cloud_metadata: ~
  - add_docker_metadata: ~
  - add_kubernetes_metadata: ~
```  
  


- 파일비트 실행
```
cd /etc/filebeat
sudo ./filebeat -e -c filebeat.yml -d "publish"
```
